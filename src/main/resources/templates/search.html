<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Search Page</title>
  <script>
    async function loadFiles() {
        try {
            const response = await fetch("/api/words/load", { method: "POST" });

            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            alert("Files loaded successfully!");
        } catch (error) {
            console.error("Error loading files:", error);
            alert("Failed to load files. Please try again.");
        }
    }

    async function submitSearch() {
        const query = document.getElementById("searchQuery").value;
        if (!query.trim()) {
            alert("Please enter a search term.");
            return;
        }

        try {
            const response = await fetch(`/api/words/searchResults?query=${encodeURIComponent(query)}`);

            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            const results = await response.json();
            displayResults(results);
        } catch (error) {
            console.error("Error fetching search results:", error);
            alert("Failed to fetch search results. Please try again.");
        }
    }

    function displayResults(results) {
        const resultsDiv = document.getElementById("results");
        resultsDiv.innerHTML = "";

        if (results.length === 0) {
            resultsDiv.innerHTML = "<p>No results found.</p>";
        } else {
            const list = document.createElement("ul");
            results.forEach(result => {
                const listItem = document.createElement("li");
                listItem.innerHTML = `<a href="${result.file}" target="_blank">${result.file}</a> - ${result.occurrences} occurrences`;
                list.appendChild(listItem);
            });
            resultsDiv.appendChild(list);
        }
    }
  </script>
</head>
<body>
<h2>Search for Words</h2>
<button onclick="loadFiles()">Load Files</button>
<input type="text" id="searchQuery" placeholder="Enter search term">
<button onclick="submitSearch()">Search</button>
<div id="results"></div>
</body>
</html>
